int av_packet_split_side_data(AVPacket *pkt) int i ; unsigned int size ; uint8_t * p ; p = pkt -> data + pkt -> size - 8 - 5; i ++ size = av_bswap32 ( ( ( const union unaligned_32 * ) p ) -> l ); if ( size > 2147483647 || p - pkt -> data < size )  if ( p [ 4 ] & 128 )  p -= size + 5; pkt -> side_data = ( av_malloc ( i * sizeof ( ( * pkt -> side_data ) ) ) ); if ( ! pkt -> side_data )  p = pkt -> data + pkt -> size - 8 - 5; i ++ size = av_bswap32 ( ( ( const union unaligned_32 * ) p ) -> l ); pkt -> side_data [ i ] . data = ( av_malloc ( ( size + 16 ) ) ); pkt -> side_data [ i ] . size = size; pkt -> side_data [ i ] . type = ( p [ 4 ] & 127 ); if ( ! pkt -> side_data [ i ] . data )  memcpy ( pkt -> side_data [ i ] . data , ( p - size ) , size ); pkt -> size -= size + 5; if ( p [ 4 ] & 128 )  p -= size + 5; 