status_t MPEG4Extractor::readMetaData() if ( mInitCheck != NO_INIT )  uint64_t psshsize = 0 ; for (size_t i = 0; i < mPssh.Length(); i++) psshsize += 20 + mPssh [ i ] . datalen; if ( mPssh [ i ] . datalen > kMAX_ALLOCATION - 20 || psshsize > kMAX_ALLOCATION )  if ( psshsize )  char * buf = ( char * ) malloc ( psshsize ) ; if ( ! buf )  char * ptr = buf ; for (size_t i = 0; i < mPssh.Length(); i++) memcpy ( ptr , mPssh [ i ] . uuid , 20 ); memcpy ( ptr + 20 , mPssh [ i ] . data , mPssh [ i ] . datalen ); ptr += ( 20 + mPssh [ i ] . datalen ); 