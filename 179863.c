int CVE_2012_2669_PATCHED_main(void) int fd , len , sock_opt ; struct cn_msg * message ; fd = socket ( AF_NETLINK , SOCK_DGRAM , NETLINK_CONNECTOR ); message = ( struct cn_msg * ) kvp_send_buffer; message -> id . idx = CN_KVP_IDX; message -> id . val = CN_KVP_VAL; message -> ack = 0; message -> len = sizeof ( struct hv_kvp_msg ); len = netlink_send ( fd , message ); if ( len < 0 )  syslog ( LOG_ERR , "netlink_send failed; error:%d" , len ); 