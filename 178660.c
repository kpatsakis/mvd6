static void CVE_2009_2484_PATCHED_Win32AddConnection( access_t *p_access, char char *psz_user, char char *psz_domain ) char psz_remote [ MAX_PATH ] , psz_server [ MAX_PATH ] , psz_share [ MAX_PATH ] ; HINSTANCE hdll = LoadLibrary ( _T ( "MPR.DLL" ) ) ; if ( ! hdll )  OurWNetAddConnection2 = ( void * ) GetProcAddress ( hdll , _T ( "WNetAddConnection2A" ) ); if ( ! OurWNetAddConnection2 )  psz_share [ 0 ] = 0; snprintf ( psz_remote , sizeof ( psz_remote ) , "\\\\%s\\%s" , psz_server , psz_share ); net_resource . lpRemoteName = psz_remote; i_result = OurWNetAddConnection2 ( & net_resource , psz_pwd , psz_user , 0 ); if ( i_result != NO_ERROR )  msg_Dbg ( p_access , "connected to %s" , psz_remote ); if ( i_result != ERROR_ALREADY_ASSIGNED && i_result != ERROR_DEVICE_ALREADY_REMEMBERED )  msg_Dbg ( p_access , "already connected to %s" , psz_remote ); msg_Dbg ( p_access , "failed to connect to %s" , psz_remote ); 