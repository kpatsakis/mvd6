static void CVE_2010_4342_PATCHED_aun_incoming(struct sk_buff *skb, struct aunhdr *ah, size_t len) struct iphdr * ip = ip_hdr ( skb ) ; unsigned char stn = ntohl ( ip -> saddr ) & 0xff ; struct dst_entry * dst = skb_dst ( skb ) ; struct ec_device * edev = NULL ; struct sk_buff * newskb ; if ( dst )  edev = dst -> dev -> ec_ptr; if ( ! edev )  if ( ( sk = ec_listening_socket ( ah -> port , stn , edev -> net ) ) == NULL )  newskb = alloc_skb ( ( len - sizeof ( struct aunhdr ) + 15 ) & ~15 , GFP_ATOMIC ); if ( newskb == NULL )  memcpy ( skb_put ( newskb , len - sizeof ( struct aunhdr ) ) , ( void * ) ( ah + 1 ) , len - sizeof ( struct aunhdr ) ); 