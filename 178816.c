static av_cold int CVE_2013_0848_VULN_decode_init(AVCodecContext *avctx) HYuvContext * s = avctx -> priv_data ; memset ( s -> vlc , 0 , 3 * sizeof ( VLC ) ); avctx -> coded_frame = & s -> picture; avcodec_get_frame_defaults ( & s -> picture ); s -> interlaced = s -> height > 288; s -> bgr32 = 1; if ( avctx -> extradata_size )  if ( ( avctx -> bits_per_coded_sample & 7 ) && avctx -> bits_per_coded_sample != 12 )  s -> version = 1; if ( s -> version == 2 )  if ( avctx -> extradata_size < 4 )  method = ( ( uint8_t * ) avctx -> extradata ) [ 0 ]; s -> decorrelate = method & 64 ? 1 : 0; s -> predictor = method & 63; s -> bitstream_bpp = ( ( uint8_t * ) avctx -> extradata ) [ 1 ]; if ( s -> bitstream_bpp == 0 )  s -> bitstream_bpp = avctx -> bits_per_coded_sample & ~7; interlace = ( ( ( uint8_t * ) avctx -> extradata ) [ 2 ] & 0x30 ) >> 4; s -> interlaced = ( interlace == 1 ) ? 1 : ( interlace == 2 ) ? 0 : s -> interlaced; s -> context = ( ( uint8_t * ) avctx -> extradata ) [ 2 ] & 0x40 ? 1 : 0; if ( read_huffman_tables ( s , ( ( uint8_t * ) avctx -> extradata ) + 4 , avctx -> extradata_size - 4 ) < 0 )  switch ( avctx -> bits_per_coded_sample & 7 )  s -> decorrelate = avctx -> bits_per_coded_sample >= 24; s -> predictor = MEDIAN; s -> decorrelate = 0; s -> predictor = LEFT; s -> decorrelate = 0; s -> bitstream_bpp = avctx -> bits_per_coded_sample & ~7; s -> context = 0; if ( read_old_huffman_tables ( s ) < 0 )  switch ( s -> bitstream_bpp )  avctx -> pix_fmt = PIX_FMT_YUV420P; if ( s -> yuy2 )  avctx -> pix_fmt = PIX_FMT_YUYV422; if ( s -> bgr32 )  if ( ( avctx -> pix_fmt == PIX_FMT_YUV422P || avctx -> pix_fmt == PIX_FMT_YUV420P ) && avctx -> width & 1 )  alloc_temp ( s ); 