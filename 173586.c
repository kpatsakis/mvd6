int CONF_modules_load_file(const char *filename,const char *appname,unsigned long flags) conf = NCONF_new ( ( ( void * ) 0 ) ); if ( ! conf )  if ( filename == ( ( void * ) 0 ) )  file = CONF_get1_default_config_file ( ); char *CONF_get1_default_config_file() char * file ; int len ; file = getenv ( "OPENSSL_CONF" ); if ( file )  return BUF_strdup ( file ) ; len = ( strlen ( X509_get_default_cert_area ( ) ) ); len ++; len += strlen ( "openssl.cnf" ); file = ( CRYPTO_malloc ( ( ( int ) len ) + 1 , "conf_mod.c" , 561 ) ); if ( ! file )  return ( ( void * ) 0 ) ; return file ; if ( ! file )  file = ( ( char * ) filename ); if ( NCONF_load ( conf , file , ( ( void * ) 0 ) ) <= 0 )  ret = CONF_modules_load ( conf , appname , flags ); int CONF_modules_load(const CONF *cnf,const char *appname,unsigned long flags) struct stack_st_CONF_VALUE * values ; CONF_VALUE * vl ; char * vsection = ( ( void * ) 0 ) ; int ret ; int i ; if ( ! cnf )  if ( appname )  vsection = NCONF_get_string ( cnf , ( ( void * ) 0 ) , appname ); if ( ! appname || ! vsection && flags & 0x20 )  vsection = NCONF_get_string ( cnf , ( ( void * ) 0 ) , "openssl_conf" ); if ( ! vsection )  values = NCONF_get_section ( cnf , vsection ); if ( ! values )  for (i = 0; i < sk_num(((_STACK *)((1?values : ((struct stack_st_CONF_VALUE *)0))))); i++) vl = ( ( CONF_VALUE * ) ( sk_value ( ( ( _STACK * ) ( ( 1 ? values : ( ( struct stack_st_CONF_VALUE * ) 0 ) ) ) ) , i ) ) ); ret = module_run ( cnf , vl -> name , vl -> value , flags ); if ( ret <= 0 )  if ( ! ( flags & 0x1 ) )  static int module_run(const CONF *cnf,char *name,char *value,unsigned long flags) CONF_MODULE * md ; md = module_find ( name ); static CONF_MODULE *module_find(char *name) int nchar ; char * p ; p = strrchr ( name , '.' ); if ( p )  nchar = ( strlen ( name ) ); if ( ! strncmp ( ( tmod -> name ) , name , nchar ) )  