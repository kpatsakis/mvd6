int avcodec_encode_audio(AVCodecContext *avctx,uint8_t *buf,int buf_size,const short *samples) AVFrame * frame ; if ( samples )  frame = & frame0; avcodec_get_frame_defaults ( frame ); void avcodec_get_frame_defaults(AVFrame *frame) memset ( frame , 0 , sizeof ( AVFrame ) ); frame -> pts = frame -> pkt_dts = frame -> pkt_pts = ( ( int64_t ) 0x8000000000000000UL ); av_frame_set_best_effort_timestamp ( frame , ( ( int64_t ) 0x8000000000000000UL ) ); av_frame_set_pkt_duration ( frame , 0 ); av_frame_set_pkt_pos ( frame , ( - 1 ) ); av_frame_set_pkt_size ( frame , - 1 ); frame -> key_frame = 1; frame -> format = - 1; frame -> extended_data = frame -> data; 