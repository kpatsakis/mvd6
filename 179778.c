gchar *ep_strconcat(const gchar *string1,... ) gsize l ; gchar * s ; if ( ! string1 )  l = 1 + strlen ( string1 ); s = ( va_arg ( args , gchar * ) ) while ( s )  l += strlen ( s ); concat = ( ep_alloc ( l ) ); void *ep_alloc(size_t size) return emem_alloc ( size , & ep_packet_mem ) ; static void *emem_alloc(size_t size,emem_header_t *mem) void * buf = ( mem -> memory_alloc ) ( size , mem ) ; emem_scrub_memory ( buf , size , ! 0 ); static void emem_scrub_memory(char *buf,size_t size,gboolean alloc) if ( alloc )  for (offset = 0; offset + sizeof(guint ) <= size; offset += sizeof(guint )) * ( ( guint * ) ( ( void * ) ( buf + offset ) ) ) = scrubbed_value; if ( offset < size )  * ( ( guint8 * ) ( buf + offset ) ) = ( scrubbed_value >> 24 ); offset ++; if ( offset < size )  * ( ( guint8 * ) ( buf + offset ) ) = ( scrubbed_value >> 16 & 0xFF ); offset ++; if ( offset < size )  * ( ( guint8 * ) ( buf + offset ) ) = ( scrubbed_value >> 8 & 0xFF ); return buf ; ptr = concat; ptr = g_stpcpy ( ptr , string1 ); ptr = g_stpcpy ( ptr , s ); return concat ; 