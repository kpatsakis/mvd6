static int CVE_2014_8546_PATCHED_cinepak_decode_vectors (CinepakContext *s, cvid_strip int chunk_id, int size, const uint8_t *data) const uint8_t * eod = ( data + size ) ; uint32_t flag , mask ; uint8_t * cb0 , * cb1 , * cb2 , * cb3 ; int x , y ; char * ip0 , * ip1 , * ip2 , * ip3 ; flag = 0; mask = 0; for (y=strip->y1; y < strip->y2; y+=4) ip0 = ip1 = ip2 = ip3 = s -> frame -> data [ 0 ] + ( s -> palette_video ? strip -> x1 : strip -> x1 * 3 ) + ( y * s -> frame -> linesize [ 0 ] ); for (x=strip->x1; x < strip->x2; x+=4) if ( ( chunk_id & 0x01 ) && ! ( mask >>= 1 ) )  if ( ( data + 4 ) > eod )  flag = AV_RB32 ( data ); data += 4; mask = 0x80000000; if ( ! ( chunk_id & 0x01 ) || ( flag & mask ) )  if ( ! ( chunk_id & 0x02 ) && ! ( mask >>= 1 ) )  if ( ( data + 4 ) > eod )  flag = AV_RB32 ( data ); data += 4; mask = 0x80000000; if ( ( chunk_id & 0x02 ) || ( ~flag & mask ) )  uint8_t * p ; if ( data >= eod )  p = strip -> v1_codebook [ * data ++ ]; if ( s -> palette_video )  p += 6; p += 3; p -= 9; memcpy ( ip0 + 0 , p , 3 ); memcpy ( ip0 + 3 , p , 3 ); memcpy ( ip0 + 6 , p , 3 ); memcpy ( ip0 + 9 , p , 3 ); if ( flag & mask )  if ( ( data + 4 ) > eod )  cb0 = strip -> v4_codebook [ * data ++ ]; cb1 = strip -> v4_codebook [ * data ++ ]; cb2 = strip -> v4_codebook [ * data ++ ]; cb3 = strip -> v4_codebook [ * data ++ ]; if ( s -> palette_video )  memcpy ( ip0 + 0 , cb0 + 0 , 6 ); memcpy ( ip0 + 6 , cb1 + 0 , 6 ); if ( s -> palette_video )  ip0 += 4; ip0 += 12; 